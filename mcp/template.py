from troposphere import Tags, Tag, Template
import troposphere.s3 as s3
t = Template()

default_tags = Tags(
    Tag('Project', 'MalwareTypeClassificationProject')
)

bucket = s3.Bucket('MalwareClassificationBucket',
                   DeletionPolicy='Retain', UpdateReplacePolicy='Retain')
bucket.NotificationConfiguration = s3.NotificationConfiguration(
    EventBridgeConfiguration=s3.EventBridgeConfiguration(
        EventBridgeEnabled=True
    )
)
bucket.LifecycleConfiguration = s3.LifecycleConfiguration(
    Rules=[s3.LifecycleRule(
        Id='MetadataRule',
        Prefix='metadata',
        Status='Enabled',
        Transitions=[s3.LifecycleRuleTransition(
            TransitionInDays=180,
            StorageClass='STANDARD_IA'
        )]
    )]
)

bucket.Tags = default_tags

t.add_resource(bucket)

print(t.to_json())
